#!/bin/bash

sudo dnf copr enable szydell/system76
sudo dnf install system76-driver

# Update sources (dnf copr enable usually refreshes metadata)
echo "Ensuring package metadata is up to date..."
sudo dnf check-update

# Install System76 software
echo "Installing System76 software components..."
# Package names might vary slightly in COPR (e.g., system76-firmware vs system76-firmware-daemon)
sudo dnf install -y \
    system76* \
    firmware-manager

sudo systemctl enable --now system76-firmware-daemon
sudo systemctl mask power-profiles-daemon.service
sudo gpasswd -a $USER adm
sudo systemctl enable com.system76.PowerDaemon.service system76-power-wake
sudo systemctl start com.system76.PowerDaemon.service
sudo systemctl enable dkms

# Gnome shell extension
git clone https://github.com/pop-os/gnome-shell-extension-system76-power.git
cd gnome-shell-extension-system76-power
sudo dnf install nodejs-typescript
make
make install


